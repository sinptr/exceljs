{"version":3,"sources":["../../../lib/doc/anchor.js"],"names":["colCache","require","Anchor","worksheet","address","offset","nativeCol","nativeColOff","nativeRow","nativeRowOff","decoded","decodeAddress","col","row","asInstance","model","prototype","Math","min","colWidth","v","floor","rowHeight","getColumn","isCustomWidth","width","getRow","height","value","module","exports"],"mappings":"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","file":"anchor.js","sourcesContent":["'use strict';\r\n\r\nconst colCache = require('../utils/col-cache');\r\n\r\nconst Anchor = function(worksheet, address, offset = 0) {\r\n  if (!address) {\r\n    this.nativeCol = 0;\r\n    this.nativeColOff = 0;\r\n    this.nativeRow = 0;\r\n    this.nativeRowOff = 0;\r\n  } else if (typeof address === 'string') {\r\n    const decoded = colCache.decodeAddress(address);\r\n    this.nativeCol = decoded.col + offset;\r\n    this.nativeColOff = 0;\r\n    this.nativeRow = decoded.row + offset;\r\n    this.nativeRowOff = 0;\r\n  } else if (address.nativeCol) {\r\n    this.nativeCol = address.nativeCol || 0;\r\n    this.nativeColOff = address.nativeColOff || 0;\r\n    this.nativeRow = address.nativeRow || 0;\r\n    this.nativeRowOff = address.nativeRowOff || 0;\r\n  } else if (address.col) {\r\n    this.col = address.col + offset;\r\n    this.row = address.row + offset;\r\n  } else {\r\n    this.nativeCol = 0;\r\n    this.nativeColOff = 0;\r\n    this.nativeRow = 0;\r\n    this.nativeRowOff = 0;\r\n  }\r\n\r\n  this.worksheet = worksheet;\r\n};\r\n\r\nAnchor.asInstance = function(model) {\r\n  return model instanceof Anchor || model == null ? model : new Anchor(model);\r\n};\r\n\r\nAnchor.prototype = {\r\n  get col() {\r\n    return this.nativeCol + (Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth);\r\n  },\r\n  set col(v) {\r\n    this.nativeCol = Math.floor(v);\r\n    this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\r\n  },\r\n  get row() {\r\n    return this.nativeRow + (Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight);\r\n  },\r\n  set row(v) {\r\n    this.nativeRow = Math.floor(v);\r\n    this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\r\n  },\r\n  get colWidth() {\r\n    return this.worksheet && this.worksheet.getColumn(this.nativeCol + 1) && this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth\r\n      ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000)\r\n      : 640000;\r\n  },\r\n  get rowHeight() {\r\n    return this.worksheet && this.worksheet.getRow(this.nativeRow + 1) && this.worksheet.getRow(this.nativeRow + 1).height\r\n      ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000)\r\n      : 180000;\r\n  },\r\n\r\n  get model() {\r\n    return {\r\n      nativeCol: this.nativeCol,\r\n      nativeColOff: this.nativeColOff,\r\n      nativeRow: this.nativeRow,\r\n      nativeRowOff: this.nativeRowOff,\r\n    };\r\n  },\r\n  set model(value) {\r\n    this.nativeCol = value.nativeCol;\r\n    this.nativeColOff = value.nativeColOff;\r\n    this.nativeRow = value.nativeRow;\r\n    this.nativeRowOff = value.nativeRowOff;\r\n  },\r\n};\r\n\r\nmodule.exports = Anchor;\r\n"]}