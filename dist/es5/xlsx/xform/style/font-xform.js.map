{"version":3,"sources":["../../../../../lib/xlsx/xform/style/font-xform.js"],"names":["ColorXform","require","BooleanXform","IntegerXform","StringXform","UnderlineXform","_","utils","BaseXform","FontXform","module","exports","options","OPTIONS","map","b","prop","xform","tag","attr","i","u","charset","color","condense","extend","family","outline","vertAlign","scheme","shadow","strike","sz","fontNameTag","tagName","inherits","render","xmlStream","model","openNode","each","defn","closeNode","parseOpen","node","parser","name","parseText","text","parseClose","item","undefined"],"mappings":"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","file":"font-xform.js","sourcesContent":["'use strict';\r\n\r\nvar ColorXform = require('./color-xform');\r\nvar BooleanXform = require('../simple/boolean-xform');\r\nvar IntegerXform = require('../simple/integer-xform');\r\nvar StringXform = require('../simple/string-xform');\r\nvar UnderlineXform = require('./underline-xform');\r\n\r\nvar _ = require('../../../utils/under-dash');\r\nvar utils = require('../../../utils/utils');\r\nvar BaseXform = require('../base-xform');\r\n\r\n// Font encapsulates translation from font model to xlsx\r\nvar FontXform = module.exports = function(options) {\r\n  this.options = options || FontXform.OPTIONS;\r\n\r\n  this.map = {\r\n    b: { prop: 'bold', xform: new BooleanXform({tag: 'b', attr: 'val'}) },\r\n    i: { prop: 'italic', xform: new BooleanXform({tag: 'i', attr: 'val'}) },\r\n    u: { prop: 'underline', xform: new UnderlineXform() },\r\n    charset: { prop: 'charset', xform: new IntegerXform({tag: 'charset', attr: 'val'}) },\r\n    color: { prop: 'color', xform: new ColorXform() },\r\n    condense: { prop: 'condense', xform: new BooleanXform({tag: 'condense', attr: 'val'}) },\r\n    extend: { prop: 'extend', xform: new BooleanXform({tag: 'extend', attr: 'val'}) },\r\n    family: { prop: 'family', xform: new IntegerXform({tag: 'family', attr: 'val'}) },\r\n    outline: { prop: 'outline', xform: new BooleanXform({tag: 'outline', attr: 'val'}) },\r\n    vertAlign: { prop: 'vertAlign', xform: new StringXform({ tag: 'vertAlign', attr: 'val' }) },\r\n    scheme: { prop: 'scheme', xform: new StringXform({tag: 'scheme', attr: 'val'}) },\r\n    shadow: { prop: 'shadow', xform: new BooleanXform({tag: 'shadow', attr: 'val'}) },\r\n    strike: { prop: 'strike', xform: new BooleanXform({tag: 'strike', attr: 'val'}) },\r\n    sz: { prop: 'size', xform: new IntegerXform({tag: 'sz', attr: 'val'}) }\r\n  };\r\n  this.map[this.options.fontNameTag] = { prop: 'name', xform: new StringXform({tag: this.options.fontNameTag, attr: 'val'}) };\r\n};\r\n\r\nFontXform.OPTIONS = {\r\n  tagName: 'font',\r\n  fontNameTag: 'name'\r\n};\r\n\r\nutils.inherits(FontXform, BaseXform, {\r\n\r\n  get tag() { return this.options.tagName; },\r\n\r\n  render: function(xmlStream, model) {\r\n    var map = this.map;\r\n\r\n    xmlStream.openNode(this.options.tagName);\r\n    _.each(this.map, function(defn, tag) {\r\n      map[tag].xform.render(xmlStream, model[defn.prop]);\r\n    });\r\n    xmlStream.closeNode();\r\n  },\r\n\r\n  parseOpen: function(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    if (this.map[node.name]) {\r\n      this.parser = this.map[node.name].xform;\r\n      return this.parser.parseOpen(node);\r\n    }\r\n    switch (node.name) {\r\n      case this.options.tagName:\r\n        this.model = {};\r\n        return true;\r\n      default:\r\n        return false;\r\n    }\r\n  },\r\n  parseText: function(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  },\r\n  parseClose: function(name) {\r\n    if (this.parser && !this.parser.parseClose(name)) {\r\n      var item = this.map[name];\r\n      if (this.parser.model) {\r\n        this.model[item.prop] = this.parser.model;\r\n      }\r\n      this.parser = undefined;\r\n      return true;\r\n    }\r\n    switch (name) {\r\n      case this.options.tagName:\r\n        return false;\r\n      default:\r\n        return true;\r\n    }\r\n  }\r\n});\r\n"]}