{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/header-footer-xform.js"],"names":["_","require","utils","StringXform","BaseXform","HeaderFooterXform","module","exports","map","oddHeader","tag","evenHeader","firstHeader","oddFooter","evenFooter","firstFooter","inherits","render","xmlStream","model","openNode","_addAttrs","header","odd","_getRawString","even","first","footer","closeNode","config","raw","isEqual","addAttribute","parseOpen","node","parser","xform","name","differentOddEven","attributes","differentFirst","Error","JSON","stringify","parseText","text","parseClose","undefined"],"mappings":"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","file":"header-footer-xform.js","sourcesContent":["'use strict';\r\n\r\nvar _ = require('../../../utils/under-dash');\r\nvar utils = require('../../../utils/utils');\r\nvar StringXform = require('../simple/string-xform');\r\nvar BaseXform = require('../base-xform');\r\n\r\nvar HeaderFooterXform = module.exports = function() {\r\n  this.map = {\r\n    oddHeader: new StringXform({ tag: 'oddHeader' }),\r\n    evenHeader: new StringXform({ tag: 'evenHeader' }),\r\n    firstHeader: new StringXform({ tag: 'firstHeader' }),\r\n    oddFooter: new StringXform({ tag: 'oddFooter' }),\r\n    evenFooter: new StringXform({ tag: 'evenFooter' }),\r\n    firstFooter: new StringXform({ tag: 'firstFooter' })\r\n  };\r\n};\r\n\r\nutils.inherits(HeaderFooterXform, BaseXform, {\r\n\r\n  get tag() {\r\n    return 'headerFooter';\r\n  },\r\n\r\n  render: function render(xmlStream, model) {\r\n    if (model) {\r\n      xmlStream.openNode(this.tag);\r\n\r\n      this._addAttrs(xmlStream, model);\r\n\r\n      if (model.header && model.header.odd) {\r\n        this.map.oddHeader.render(xmlStream, this._getRawString(model.header.odd));\r\n      }\r\n      if (model.header && model.header.even) {\r\n        this.map.evenHeader.render(xmlStream, this._getRawString(model.header.even));\r\n      }\r\n      if (model.header && model.header.first) {\r\n        this.map.firstHeader.render(xmlStream, this._getRawString(model.header.first));\r\n      }\r\n      if (model.footer && model.footer.odd) {\r\n        this.map.oddFooter.render(xmlStream, this._getRawString(model.footer.odd));\r\n      }\r\n      if (model.footer && model.footer.even) {\r\n        this.map.evenFooter.render(xmlStream, this._getRawString(model.footer.even));\r\n      }\r\n      if (model.footer && model.footer.first) {\r\n        this.map.firstFooter.render(xmlStream, this._getRawString(model.footer.first));\r\n      }\r\n\r\n      xmlStream.closeNode();\r\n    }\r\n  },\r\n\r\n  _getRawString: function _getRawString(config) {\r\n    return config && config.raw;\r\n  },\r\n\r\n  _addAttrs: function _addAttrs(xmlStream, model) {\r\n    if ((model.header.even && !_.isEqual(model.header.odd, model.header.even)) ||\r\n      (model.footer.even && !_.isEqual(model.footer.odd, model.footer.even))) {\r\n      xmlStream.addAttribute('differentOddEven', '1');\r\n    }\r\n    if ((model.header && model.header.first) || (model.footer && model.footer.first)) {\r\n      xmlStream.addAttribute('differentFirst', '1');\r\n    }\r\n  },\r\n\r\n  parseOpen: function parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.xform.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case this.tag:\r\n        this.model = {\r\n          header: {\r\n            odd: this.map.oddHeader.model ? { raw: this.map.oddHeader.model } : null,\r\n            even: this.map.evenHeader.model ? { raw: this.map.evenHeader.model } : null,\r\n            first: this.map.firstHeader.model ? { raw: this.map.firstHeader.model } : null\r\n          },\r\n          footer: {\r\n            odd: this.map.oddFooter.model ? { raw: this.map.oddFooter.model } : null,\r\n            even: this.map.evenHeader.model ? { raw: this.map.evenFooter.model } : null,\r\n            first: this.map.firstHeader.model ? { raw: this.map.firstFooter.model } : null\r\n          },\r\n          differentOddEven: !!node.attributes.differentOddEven,\r\n          differentFirst: !!node.attributes.differentFirst\r\n        };\r\n        return true;\r\n      default:\r\n        this.parser = this.map[node.name];\r\n        if (this.parser) {\r\n          this.parser.parseOpen(node);\r\n          return true;\r\n        }\r\n        throw new Error('Unexpected xml node in parseOpen: ' + JSON.stringify(node));\r\n    }\r\n  },\r\n  parseText: function parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n    }\r\n  },\r\n  parseClose: function parseClose(name) {\r\n    if (this.parser) {\r\n      if (!this.parser.parseClose(name)) {\r\n        this.parser = undefined;\r\n      }\r\n      return true;\r\n    }\r\n    switch (name) {\r\n      case this.tag:\r\n        this.model.header = {\r\n          odd: this.map.oddHeader.model ? { raw: this.map.oddHeader.model } : null,\r\n          even: this.map.evenHeader.model ? { raw: this.map.evenHeader.model } : null,\r\n          first: this.map.firstHeader.model ? { raw: this.map.firstHeader.model } : null\r\n        };\r\n        this.model.footer = {\r\n          odd: this.map.oddFooter.model ? { raw: this.map.oddFooter.model } : null,\r\n          even: this.map.evenHeader.model ? { raw: this.map.evenFooter.model } : null,\r\n          first: this.map.firstHeader.model ? { raw: this.map.firstFooter.model } : null\r\n        };\r\n        return false;\r\n      default:\r\n        throw new Error('Unexpected xml node in parseClose: ' + name);\r\n    }\r\n  }\r\n\r\n});\r\n"]}